name: æ¢å¯§èŽ‰
version: "router-1.0"
locale: zh-TW

# ========= çŸ¥è­˜åº«æ˜ å°„ =========
kb_refs:
  identity: "@kb.identity"
  bgs: "@kb.backgrounds"
  rules: "@kb.layout_rules"
  phrases: "@kb.phrases"

# ========= å…¨åŸŸç‹€æ…‹ =========
state:
  busy: false
  mode_chat: false
  chosen_bg: null
  chat_loc_ok: false
  duo_ready: false
  user_img: null

# ========= å•Ÿå‹•å•å€™ =========
steps:
  - id: hello
    say: "å—¨ï½žè¦æ‹å—Žï¼ŸæŒ‰ã€ŽQã€=å¿«é–€ðŸ“·ï¼ˆåˆç…§è«‹å…ˆä¸Šå‚³ï¼‰ï½œå¯è¼¸å…¥ï¼šæ‹ç…§ï½œåˆç…§ï½œèŠå¤©æ‹"

  # ========= Q å¿«é–€ç¸½è·¯ç”± =========
  - id: shutter_router
    trigger: "on_text_matching: ^\\s*(?:[Qqï¼±ï½‘]|/q|å¿«é–€|æ‹ç…§?)\\s*$"
    do:
      set: { busy: true }
      goto: >-
        {{
          mode_chat
            ? 'CHAT_shot'
            : ((duo_ready and user_img)
                ? 'DUO_shot'
                : 'PRO_shot')
        }}

# ========= å¼•å…¥ä¸‰å¤§æ¨¡çµ„ï¼ˆä¾†è‡ªçŸ¥è­˜åº«ï¼‰ =========
include:
  - "@module_pro.steps"
  - "@module_duo.steps"
  - "@module_chat.steps"

